# Task: Improve Test Coverage

**Session ID:** orch-20260205-traffic-ai
**Source:** Orchestrator
**Context:** Test coverage is below 70% target, need to add missing tests
**Priority:** P1
**Dependencies:** 02_run_tests.task.md
**Created At:** 2026-02-05 22:52

---

## ðŸ“‹ Objective

Improve test coverage to â‰¥70% by adding missing unit and integration tests identified in the GitHub Issues.

## ðŸŽ¯ Scope

**In Scope:**
- Add ANPR unit tests with sample vehicle images
- Add speed estimation accuracy validation test
- Add lane violation real video test
- Improve route test coverage

**Out of Scope:**
- Changing AI logic
- Modifying existing tests (unless fixing bugs)

---

## ðŸ“š Context

### Incomplete Test Criteria (from GitHub Issues)
- **Issue #7:** Speed estimation accuracy within Â±10% margin
- **Issue #8:** Lane violation works on test video with visible lanes
- **Issue #9:** OCR accuracy â‰¥70% under good lighting, unit test with sample images
- **Issue #15:** Test coverage â‰¥70%

### Test Directory Structure
```
tests/
â”œâ”€â”€ generate_test_data.py
â”œâ”€â”€ test_anpr.py
â”œâ”€â”€ test_detector.py
â”œâ”€â”€ test_sockets_e2e.py  <-- NEW: Standard for E2E testing (Replaces test_e2e_real_video.py)
â”œâ”€â”€ test_routes.py
â””â”€â”€ test_violations.py
```

---

## âœ… Definition of Done

- [ ] ANPR unit test added with sample plate image
- [ ] Speed accuracy test added (verifies Â±10% margin)
- [ ] Lane detection test runs on actual video
- [ ] Overall test coverage â‰¥70%
- [ ] All new tests pass

## ðŸ“ Expected Artifacts

| File | Purpose |
|------|---------|
| `tests/test_anpr.py` | Extended ANPR tests |
| `tests/test_speed.py` | New speed accuracy tests |
| `03_improve_coverage.result.md` | Summary of added tests |

## ðŸš« Constraints

- Use existing test data from `tests/` or `test_data/`
- Follow pytest conventions
- Tests must be deterministic (not flaky)

---

*Generated by /mode-orchestrator workflow*
